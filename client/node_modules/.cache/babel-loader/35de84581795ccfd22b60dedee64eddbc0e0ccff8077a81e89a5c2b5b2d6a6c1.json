{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useParams}from\"react-router-dom\";import axios from\"../axios\";import TaskList from\"../components/TaskList\";import{toast}from\"react-toastify\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ProjectDetail(){var _project$members;const{id}=useParams();// projectId from URL\nconst[project,setProject]=useState(null);const[users,setUsers]=useState([]);const[selectedUser,setSelectedUser]=useState(\"\");const[loading,setLoading]=useState(true);const token=localStorage.getItem(\"authToken\");// ‚úÖ Fetch project details\nconst fetchProject=async()=>{try{const res=await axios.get(\"/projects/\".concat(id),{headers:{Authorization:token}});setProject(res.data);}catch(err){var _err$response,_err$response2,_err$response2$data;console.error(\"‚ùå Failed to fetch project:\",((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message);toast.error(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||\"Failed to load project\");}finally{setLoading(false);}};// ‚úÖ Fetch users (corrected endpoint)\nconst fetchUsers=async()=>{try{const res=await axios.get(\"/users\",{headers:{Authorization:token}});console.log(\"‚úÖ Users fetched:\",res.data);setUsers(res.data);}catch(err){var _err$response3;console.error(\"‚ùå Failed to fetch users:\",((_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.data)||err.message);toast.error(\"Failed to fetch users\");}};// ‚úÖ Add member to project\nconst handleAddMember=async()=>{if(!selectedUser)return toast.error(\"Please select a user\");try{await axios.post(\"/projects/\".concat(id,\"/members\"),{userId:selectedUser},{headers:{Authorization:token}});toast.success(\"‚úÖ Member added\");setSelectedUser(\"\");fetchProject();// Refresh members list\n}catch(err){var _err$response4,_err$response5,_err$response5$data;console.error(\"‚ùå Failed to add member:\",((_err$response4=err.response)===null||_err$response4===void 0?void 0:_err$response4.data)||err.message);toast.error(((_err$response5=err.response)===null||_err$response5===void 0?void 0:(_err$response5$data=_err$response5.data)===null||_err$response5$data===void 0?void 0:_err$response5$data.message)||\"Failed to add member\");}};useEffect(()=>{fetchProject();fetchUsers();},[id]);if(loading)return/*#__PURE__*/_jsx(\"p\",{className:\"p-6\",children:\"Loading...\"});if(!project)return/*#__PURE__*/_jsx(\"p\",{className:\"p-6 text-red-600\",children:\"\\u274C Project not found\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold mb-2\",children:project.name}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-4 text-gray-600\",children:project.description}),/*#__PURE__*/_jsx(TaskList,{projectId:project._id}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 bg-white rounded shadow p-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-2\",children:\"\\uD83D\\uDC65 Project Members\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"mb-4 list-disc pl-5 text-gray-700\",children:((_project$members=project.members)===null||_project$members===void 0?void 0:_project$members.length)>0?project.members.map((member,i)=>/*#__PURE__*/_jsxs(\"li\",{children:[member.name,\" (\",member.email,\")\"]},i)):/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"No members yet.\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 items-center\",children:[/*#__PURE__*/_jsxs(\"select\",{value:selectedUser,onChange:e=>setSelectedUser(e.target.value),className:\"border px-3 py-2 rounded\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Select User --\"}),users.map(u=>/*#__PURE__*/_jsxs(\"option\",{value:u._id,children:[u.name,\" (\",u.email,\")\"]},u._id))]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAddMember,className:\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700\",children:\"\\u2795 Add Member\"})]})]})]});}export default ProjectDetail;","map":{"version":3,"names":["React","useEffect","useState","useParams","axios","TaskList","toast","jsx","_jsx","jsxs","_jsxs","ProjectDetail","_project$members","id","project","setProject","users","setUsers","selectedUser","setSelectedUser","loading","setLoading","token","localStorage","getItem","fetchProject","res","get","concat","headers","Authorization","data","err","_err$response","_err$response2","_err$response2$data","console","error","response","message","fetchUsers","log","_err$response3","handleAddMember","post","userId","success","_err$response4","_err$response5","_err$response5$data","className","children","name","description","projectId","_id","members","length","map","member","i","email","value","onChange","e","target","u","onClick"],"sources":["C:/Gyan/Full stack web development/project-management-app/client/src/pages/ProjectDetail.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport axios from \"../axios\";\r\nimport TaskList from \"../components/TaskList\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nfunction ProjectDetail() {\r\n  const { id } = useParams(); // projectId from URL\r\n  const [project, setProject] = useState(null);\r\n  const [users, setUsers] = useState([]);\r\n  const [selectedUser, setSelectedUser] = useState(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const token = localStorage.getItem(\"authToken\");\r\n\r\n  // ‚úÖ Fetch project details\r\n  const fetchProject = async () => {\r\n    try {\r\n      const res = await axios.get(`/projects/${id}`, {\r\n        headers: { Authorization: token },\r\n      });\r\n      setProject(res.data);\r\n    } catch (err) {\r\n      console.error(\"‚ùå Failed to fetch project:\", err.response?.data || err.message);\r\n      toast.error(err.response?.data?.message || \"Failed to load project\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // ‚úÖ Fetch users (corrected endpoint)\r\n  const fetchUsers = async () => {\r\n    try {\r\n      const res = await axios.get(\"/users\", {\r\n        headers: { Authorization: token },\r\n      });\r\n      console.log(\"‚úÖ Users fetched:\", res.data);\r\n      setUsers(res.data);\r\n    } catch (err) {\r\n      console.error(\"‚ùå Failed to fetch users:\", err.response?.data || err.message);\r\n      toast.error(\"Failed to fetch users\");\r\n    }\r\n  };\r\n\r\n  // ‚úÖ Add member to project\r\n  const handleAddMember = async () => {\r\n    if (!selectedUser) return toast.error(\"Please select a user\");\r\n\r\n    try {\r\n      await axios.post(\r\n        `/projects/${id}/members`,\r\n        { userId: selectedUser },\r\n        { headers: { Authorization: token } }\r\n      );\r\n      toast.success(\"‚úÖ Member added\");\r\n      setSelectedUser(\"\");\r\n      fetchProject(); // Refresh members list\r\n    } catch (err) {\r\n      console.error(\"‚ùå Failed to add member:\", err.response?.data || err.message);\r\n      toast.error(err.response?.data?.message || \"Failed to add member\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchProject();\r\n    fetchUsers();\r\n  }, [id]);\r\n\r\n  if (loading) return <p className=\"p-6\">Loading...</p>;\r\n  if (!project) return <p className=\"p-6 text-red-600\">‚ùå Project not found</p>;\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <h1 className=\"text-2xl font-bold mb-2\">{project.name}</h1>\r\n      <p className=\"mb-4 text-gray-600\">{project.description}</p>\r\n\r\n      {/* üìã Task List */}\r\n      <TaskList projectId={project._id} />\r\n\r\n      {/* üë• Project Members */}\r\n      <div className=\"mt-8 bg-white rounded shadow p-4\">\r\n        <h2 className=\"text-xl font-bold mb-2\">üë• Project Members</h2>\r\n\r\n        <ul className=\"mb-4 list-disc pl-5 text-gray-700\">\r\n          {project.members?.length > 0 ? (\r\n            project.members.map((member, i) => (\r\n              <li key={i}>\r\n                {member.name} ({member.email})\r\n              </li>\r\n            ))\r\n          ) : (\r\n            <p className=\"text-sm text-gray-500\">No members yet.</p>\r\n          )}\r\n        </ul>\r\n\r\n        <div className=\"flex gap-2 items-center\">\r\n          <select\r\n            value={selectedUser}\r\n            onChange={(e) => setSelectedUser(e.target.value)}\r\n            className=\"border px-3 py-2 rounded\"\r\n          >\r\n            <option value=\"\">-- Select User --</option>\r\n            {users.map((u) => (\r\n              <option key={u._id} value={u._id}>\r\n                {u.name} ({u.email})\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <button\r\n            onClick={handleAddMember}\r\n            className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700\"\r\n          >\r\n            ‚ûï Add Member\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProjectDetail;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}